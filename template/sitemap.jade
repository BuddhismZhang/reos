doctype xml

set_content_type('text/xml')
date_format = "%Y-%m-%dT%H:%M:%S+00:00"
posts = get_data(type="post", status=['public', 'secret'], limit=300)

//
    This is a XML sitemap file. Which is supported by many search engines like Google.
    You can find more information about XML sitemap on `http://sitemaps.org`.
    Generated by farbox theme reos, theme by oyiadin.

urlset(xmlns="http://www.sitemaps.org/schemas/sitemap/0.9")
    url
        loc= "http://" + site.domain
        lastmod
            {{ posts[0].date.format(date_format) }}
        changefreq weekly
        priority 1.0

    if has('posts')
        url
            loc= "http://" + site.domain + "/archive"
            lastmod
                {{ posts[0].date.format(date_format) }}
            changefreq monthly
            priority 1.0

    if site.tags
        url
            loc= "http://" + site.domain + "/tags"
            lastmod
                {{ posts[0].date.format(date_format) }}
            changefreq monthly
            priority 1.0

    if has('images')
        url
            loc= "http://" + site.domain + "/album"
            lastmod
                // 等待补充
            changefreq monthly
            priority 1.0

    isaid = get_doc('isaid.md') or get_doc('isaid.txt')
    if isaid
        url
            loc= "http://" + site.domain + "/isaid"
            lastmod
                {{ get_comments(isaid)[0].date }}
            changefreq monthly
            priority 1.0

    about = get_doc('about.md') or get_doc('about.txt')
    if about
        url
            loc= "http://" + site.domain + "/about"
            lastmod
                {{ about.date.format(date_format) }}
            changefreq monthly
            priority 1.0

    links = get_doc('links.md') or get_doc('links.txt')
    if links
        url
            loc= "http://" + site.domain + "/links"
            lastmod
                {{ links.date.format(date_format) }}
            changefreq monthly
            priority 1.0

    for post in posts
        url
            loc= "http://" + site.domain + post.url
            lastmod
                {{ post.date.format(date_format) }}
            changefreq monthly
            priority 0.7

    for tag in site.tags
        //- tag: [tag_name, tag_count]
        url
            loc= "http://" + site.domain + "/tag/" + tag[0]
            lastmod
                {{ posts[0].date.format(date_format) }}
                //- 取得被打上 tag_name 的最新文章的发表时间
            changefreq monthly
            priority 0.4