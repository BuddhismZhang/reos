{% extends 'base.html' %}

{% from 'macro.html' import comment, render_password_block %}

{% block main %}
{% for post in posts %}
<article>
    <h1><a href="{{ post.url }}#postTitle">{{ post.title }}</a></h1>
    <p class="info">
        {{ post.date | date("%b %d, %Y (%a)") }}
        <span class="tags">
            {% for tag in post.tags %} · <a href="/tags/{{ tag }}" class="n g">{{ tag }}</a>{% endfor %} · 
        </span>
        <span class="views">
            {{ post.visits }} views
        </span>
        {% if site.configs['disqus'] %} · <a href="{{ post.url }}#disqus_thread" class="n g">Comments</a>{% endif %}
    </p>
    {% if not post.metadata['password'] %}
    {{ post.content | limit(80) }}
    {% else %}
    {{ render_password_block(no_form=True) }}
    {% endif %}
    <hr/>
</article>
{% endfor %}
{% endblock %}

{% block footer %}
{% if site.configs['disqus'] %}
<script type="text/javascript">
    var disqus_shortname = '{{ site.configs['disqus'] }}';
    (function() {
        var s = document.createElement('script');
        s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (
            document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]
        ).appendChild(s);
    }());
</script>
{% endif %}
{% endblock %}
